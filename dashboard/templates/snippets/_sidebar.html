{% load static %}
{% load ropd_extras %}

<style>
    .divider { margin: 0 !important; }
    .opo { display: none; }
</style>

<ul id="slide-out" class="sidenav sidenav-fixed">
    <li><div class="user-view">
        <div class="background">
            <img class="responsive-img" src="{% static 'assets/images/login-bg-default.jpg' %}" />
        </div>
        <img class="responsive-img circle" src="{{ user.policial.foto.url }}" />
        <span class="black-text name sombra"><strong>{{ user.nome }}</strong></span>
        <span class="black-text email sombra"><strong>{{ user.email }}</strong></span>
    </div></li>
    <li><a class="waves-effect" href="/media/MANUAL_DO_USUARIO.pdf" target="_blank"><i class="material-icons">help</i>Manual de ajuda</a></li>
    <div class="divider"></div>
    <li><a class="waves-effect" href="{% url 'index' %}"><i class="material-icons">home</i>Início</a></li>
    <li><a class="waves-effect" href="{% url 'policial:perfil' %}"><i class="material-icons">account_circle</i>Perfil</a></li>
    <li><a class="waves-effect" href="{% url 'guarnicao:listar_guarnicoes_comandante' %}" id="menuGuarnicao"><i class="material-icons">group</i>Guarnição</a></li>
    <div class="divider"></div>
    <ul class="collapsible opo">
        <li>
            <a class="collapsible-header waves-effect header-opo" tabindex="0" style="padding-left: 32px"><i class="material-icons">assignment</i>OPO </a>
            <div class="collapsible-body">
                <ul id="OPOMenu">
                {% if request.user|has_group:"CPO" %}
                    <style>
                        .opo { display: block; }
                    </style>
                        <li><a class="waves-effect" href="{% url 'opo:adicionar_opo' %}"><i class="material-icons">add</i>Inserir</a></li>
                        <li><a class="waves-effect" href="{% url 'opo:listar' %}"><i class="material-icons">list</i>Listar</a></li>
                {% endif %}
                </ul>
            </div>
        </li>
    </ul>
    <div class="divider opo"></div>
    <ul class="collapsible">
        <li>
            <a class="collapsible-header waves-effect" tabindex="0" id="HeaderMenuCriminal" style="padding-left: 32px"><i class="material-icons">announcement</i>Ocorrências</a>
            <div class="collapsible-body" id="MenuCriminal">
                <ul>
                    <li><a class="waves-effect" id="adicionarOcorrenciaCriminal"><i class="material-icons">add</i>Inserir</a></li>
                    <li><a class="waves-effect" href="{% url 'ocorrencia:listar' %}"><i class="material-icons">list</i>Listar</a></li>
                </ul>
            </div>
        </li>
    </ul>
    <div class="divider"></div>
    <ul class="collapsible">
        <li>
            <a class="collapsible-header waves-effect" tabindex="0" id="HeaderMenuRAT" style="padding-left: 32px"><i class="material-icons">directions_car</i>RAT</a>
            <div class="collapsible-body" id="MenuRAT">
                <ul>
                    <li><a class="waves-effect" id="adicionarRAT"><i class="material-icons">add</i>Inserir</a></li>
                    <li><a class="waves-effect" href="{% url 'rat:listar' %}"><i class="material-icons">list</i>Listar</a></li>
                </ul>
            </div>
        </li>
    </ul>
    <div class="divider"></div>
    {% if user.policial.cargo.cargo == "COORDENADOR DE ÁREA" or user.policial.cargo.cargo == "CICOM" or user.policial.companhia.comandante == user.policial or request.user|has_group:"CPO" %}
        <ul class="collapsible">
            <li>
                <a class="collapsible-header waves-effect" id="menuGuarnicoes" tabindex="0" style="padding-left: 32px"><i class="material-icons">adjust</i>Guarnições</a>
                <div class="collapsible-body">
                    <ul>
                        {% if request.user|has_group:"CPO" %}
                        <li><a class="waves-effect" href="{% url 'guarnicao:listar_guarnicoes_todas' %}"><i class="material-icons">list</i>Listar</a></li>
                        {% endif %}
                        <li><a class="waves-effect" href="{% url 'guarnicao:listar_guarnicoes_ativas' %}" id="menuGuarnicoesAtivas"><i class="material-icons">adjust</i>Ativas</a></li>
                    </ul>
                </div>
            </li>
        </ul>
        <script>
            $.ajax({
                url: "{% url 'guarnicao:ajax_guarnicoes_ativas' %}",
                success: (response) => {
                    $("#menuGuarnicoes").append(`<span class="new badge" data-badge-caption="ativas">${response["ativas"]}</span>`);
                    $("#menuGuarnicoesAtivas").append(`<span class="new badge" data-badge-caption="ativas">${response["ativas"]}</span>`);
                }
            });
        </script>
    <div class="divider"></div>
    {% endif %}
    <li><a class="waves-effect" href="{% url 'endereco:index' %}"><i class="material-icons">map</i>Mapa</a></li>
    <div class="divider"></div>
</ul>

<script>
$(document).ready(function(){
    {% include 'snippets/includes/verificacoes.js' %}
});
</script>